# Base configuration for CW decoder training

# Audio preprocessing
audio:
  sample_rate: 16000
  n_fft: 512
  hop_length: 160  # 10ms at 16kHz
  win_length: 400  # 25ms at 16kHz
  n_mels: 64
  f_min: 0.0
  f_max: 8000.0

# Model architecture
model:
  # CNN encoder
  cnn_channels: [32, 64, 128, 256]
  cnn_kernel_sizes: [3, 3, 3, 3]
  cnn_strides: [1, 1, 1, 1]
  cnn_pooling: [2, 2, 2, 2]

  # LSTM
  lstm_hidden_size: 256
  lstm_num_layers: 2
  lstm_dropout: 0.1
  bidirectional: true

  # Output
  num_classes: 45  # 44 characters + blank for CTC

# Training configuration
training:
  # General
  batch_size: 32
  num_epochs: 100
  samples_per_epoch: 10000

  # Optimizer
  optimizer: adamw
  learning_rate: 0.001
  weight_decay: 0.00001
  betas: [0.9, 0.999]

  # Learning rate schedule
  lr_schedule: cosine  # cosine, plateau, or none
  lr_warmup_epochs: 5
  lr_min: 0.000001

  # Gradient clipping
  grad_clip_norm: 1.0

  # Early stopping
  early_stopping_patience: 15
  early_stopping_min_epochs: 50

  # Checkpointing
  save_every_n_epochs: 5
  keep_best_n: 3

  # Validation
  val_every_n_epochs: 1

  # Device
  device: cpu  # cpu or cuda
  num_workers: 4

# Curriculum learning
curriculum:
  # Phase 1: Foundation (easy samples)
  phase1_epochs: 30
  phase1_wpm_range: [12.0, 25.0]
  phase1_snr_range: [15.0, 25.0]
  phase1_timing_variance: 0.15

  # Phase 2: Expansion (medium difficulty)
  phase2_epochs: 30
  phase2_wpm_range: [8.0, 35.0]
  phase2_snr_range: [10.0, 25.0]
  phase2_timing_variance: 0.25

  # Phase 3: Mastery (full difficulty) starts automatically after phase 2

# Data configuration
data:
  validation_path: null  # Path to validation data (when implemented)
  test_paths: []  # List of test data paths (when implemented)
  max_audio_length: 2.0  # Maximum audio length in seconds (iOS constraint)

# Export configuration
export:
  onnx_opset_version: 14
  coreml_quantize: float16  # float32, float16, or int8
  coreml_compute_units: ALL  # ALL, CPU_ONLY, or CPU_AND_GPU

# Paths
output_dir: checkpoints
log_dir: logs

# Experiment
experiment_name: null  # Will be auto-generated if not specified
seed: 42
